import math
import random
import matplotlib.pyplot as plt


def random_walk_2d(N):                                  ##Function for random walk
    x, y = 0, 0
    x_positions, y_positions = [x], [y]
    for i in range(N):
        z = random.uniform(0, 2 * math.pi)              ##generating random angle in range (0,2*pi)
        x += math.cos(z)                                ##displacement in x is cos component
        y += math.sin(z)                                ##displacement in y is sin component
        x_positions.append(x)
        y_positions.append(y)
    position = [x_positions,y_positions]
    return (position, x, y)                             ##returning a list of position after each step and last coordinate


def plotting_question2(x,y):                            ##Function for plotting in Question (b)
    for k in range(5):
        plt.plot(x[k][0],y[k][1],label='Random Walk Number '+str(k+1))

    plt.xlabel("X-direction")
    plt.ylabel("Y-direction")
    plt.legend(shadow=True)
    plt.title('Random walk in 2D for step number ='+ str(N))
    plt.grid()

    plt.savefig('Random Walk with ' + str(N) + ' steps.pdf')        ##saving the figure in pdf format
    plt.show()


def avg(List_R):                            ##Function to find average of elements in a list, required for question (c)
    sum = 0
    for i in List_R:
        sum += i
    return sum/len(List_R)


def rms(List_R):                            ##Function to find rms of elements in a list, required for question (c)
    sq_sum = 0
    for i in List_R:
        sq_sum += i**2
    return math.sqrt(sq_sum/len(List_R))


List_sqrt_N = []                            ##Generating lists for question (d)
List_rms = []

for i in range(5):                                              ##question a
    N = int(input("Please enter the number of steps:"))         ##taking value of N
    List_sqrt_N.append(float(math.sqrt(N)))
    positionlist = []
    List_x, List_y, List_R = [], [], []

    for j in range(100):                                        ##performing 100 random walks
        position, x, y = random_walk_2d(N)
        positionlist.append(position)

        List_x.append(x)
        List_y.append(y)
        R = math.sqrt(x**2+y**2)                                ##for rms value
        List_R.append(R)


    plotting_question2(positionlist,positionlist)                                   ##question b
    print("A graph has been plotted for 5 Random Walks with ", N, " steps.")

    print("List of radial distance R for 100 Random Walks (2D)= ", List_R)          ##question c

    print("rms of radial distance for 100 Random Walks (2D)= ", rms(List_R))

    print("Average displacement in X-direction = ", avg(List_x))
    print("Average displacement in Y-direction = ", avg(List_y))
    print()

    List_rms.append(rms(List_R))                                                    ##question d

print("List of square root of N= ", List_sqrt_N)
print("List of rms of Radial distance for each N= ", List_rms)

plt.plot(List_sqrt_N, List_rms, 'bx')                                   ##plotting rms with sqrt N
plt.xlabel("Square root of N")
plt.ylabel("rms of Radial Distance for each N")
plt.title('Plot of R_rms vs sqrt of N')
plt.grid()

plt.savefig('rms R vs sqrt N.pdf')
plt.show()



'''
Please enter the number of steps:250
A graph has been plotted for 5 Random Walks with  250  steps.
List of radial distance R for 100 Random Walks (2D)=  [14.374731615886096, 16.053189610054368, 13.879583972842422, 14.306360828249685, 5.4804987769795925, 6.591715474936922, 7.40260723242263, 7.833654686242419, 17.043560539701033, 15.35099971257476, 17.102762511983734, 13.756362244078856, 13.193103540016194, 1.0058232659737354, 20.93604762961341, 18.95744745272618, 22.204404363965974, 6.94377036269066, 12.644879535177628, 25.34200080872503, 9.3309122239456, 10.705646702147614, 7.626562896169393, 3.85159675660402, 8.024164213280594, 12.745686412620142, 16.015293440854457, 8.865170935358453, 7.552356565418792, 9.504615349401567, 8.210081465799894, 2.1200196476074584, 19.583504115168058, 31.6069969292798, 10.217659539308814, 13.600108107225998, 16.043331328039045, 12.643278602384681, 6.485778508968138, 9.956221091646533, 7.208730775955641, 10.758006706556428, 16.53013525521252, 9.333321058108112, 22.074916556725857, 5.207984359942558, 15.065194276537637, 13.53263243043419, 21.947085100047715, 19.159678302262332, 4.188328117262845, 19.74345886010317, 11.143236522272474, 15.78753720484983, 3.830631902589145, 19.63298020696951, 6.306090244951588, 10.921971729310135, 11.20398940160821, 16.449103996179144, 29.045069272981298, 20.914186694696408, 20.868676878804692, 18.65907329494094, 7.836770304870771, 13.986346344492407, 5.753912419709742, 16.540464411237174, 12.851703173126056, 12.183934462284757, 15.125137154705683, 27.060818959701937, 27.665145734537543, 4.331713572277734, 11.216605172247476, 23.47177150522732, 5.721161249072379, 19.231761663504738, 14.450726074130941, 20.977962839788628, 3.494931067390264, 7.746928576811049, 19.252326650374492, 11.329302137350556, 0.9313872493335231, 7.01991457206689, 12.427324399015802, 11.896459413464878, 5.853861862210996, 23.488798018053387, 16.48945739289181, 7.83912200684455, 17.561553420794866, 7.170420117670773, 22.761341214486244, 27.088221968625582, 12.678446514725563, 12.390138256480254, 6.45944498791288, 3.453441940613405]
rms of radial distance for 100 Random Walks (2D)=  14.808983460146171
Average displacement in X-direction =  1.5478580963803175
Average displacement in Y-direction =  0.7243044338434637

Please enter the number of steps:500
A graph has been plotted for 5 Random Walks with  500  steps.
List of radial distance R for 100 Random Walks (2D)=  [5.858846796405756, 13.206367391865424, 18.921012419466017, 20.954528401999617, 8.985066571165792, 19.8585313099647, 17.715609039136694, 3.245162425212848, 13.957423775685522, 6.676987519490923, 30.07746301920579, 14.381808549878643, 33.3777870819135, 24.349719061544388, 38.054654371375655, 14.122824303736703, 23.283174978606315, 38.777927726995294, 29.754399091847002, 21.13348152710219, 31.278371200781415, 10.074035687989483, 16.07979274021327, 28.384227882553404, 24.665278479893573, 18.0219815769856, 42.7497716573402, 25.422355958576897, 24.650521423679493, 26.30229521463283, 25.589459823669404, 16.912948643327038, 12.065338447877298, 9.782339416452519, 15.266386656344583, 20.798759960973108, 17.74064432173634, 10.614539698272317, 24.841355394965955, 13.158256850002484, 26.331400294802123, 10.321624924805382, 5.4939053169718015, 24.22684096939483, 24.018474540007247, 14.18057791635179, 15.55090462462028, 21.750726023212568, 10.920569975559655, 23.115629296617506, 35.65267423751753, 7.957092747227243, 25.829647704802177, 10.394544763913538, 6.08530612831039, 7.034286147127798, 33.90172171845999, 5.905430186460612, 30.4877524789807, 25.897058791902825, 3.1970593869150856, 5.252020980212459, 14.755027116890236, 3.9628808750063853, 29.564170335547203, 16.64880928276225, 45.43178452917698, 12.3532003209966, 23.404012889554433, 17.515264698871267, 12.564408147149155, 37.842591633831525, 14.19025213148246, 29.189210772045623, 20.176194829255998, 22.6545631191566, 14.836311679637703, 21.472201938787908, 13.377963221044004, 15.113012166210327, 13.959292235210235, 22.168157065362127, 21.837488223935566, 16.212691399645134, 27.61967710841538, 10.534974692319462, 9.954936696287218, 27.6379492178917, 13.027694754679766, 22.618950734238556, 19.709634732885295, 23.152166013906974, 14.03283767366354, 6.854861047845276, 31.854555869685875, 8.850428314080029, 27.277974329223397, 5.940033277265151, 34.90575978596398, 22.19749373988533]
rms of radial distance for 100 Random Walks (2D)=  21.468669791136715
Average displacement in X-direction =  -0.36211738218909195
Average displacement in Y-direction =  0.8346737817800651

Please enter the number of steps:800
A graph has been plotted for 5 Random Walks with  800  steps.
List of radial distance R for 100 Random Walks (2D)=  [11.865848613124884, 38.560054253986465, 43.72463103925877, 41.77244550446143, 34.03592682006444, 36.733012861131165, 26.767191282405687, 34.60628142838677, 34.858792754627075, 13.59035122499416, 19.52230872301453, 20.170188717586484, 49.88734717780799, 57.04311510392778, 12.154828686993461, 12.443296698604538, 21.67000844749287, 3.3259350028567383, 42.75417385567329, 30.25491074093833, 14.37321612144435, 21.166236157918835, 36.60109260339034, 35.28067836047696, 39.34967299545606, 7.592689345817342, 78.71546140806782, 18.696245921915406, 8.892070015941334, 30.302519633412366, 16.240692030642094, 4.626870275974419, 45.89480177833288, 9.785580582870491, 11.558914971661613, 40.747494306775785, 21.453786208603514, 18.93479096124788, 6.462507514273964, 12.409609241066958, 25.76228400482126, 45.307335126283796, 45.85769375228297, 30.162955496079583, 11.410909018325507, 19.02737370949538, 26.96126536367198, 36.116438375961025, 35.67230991100578, 27.169387776821683, 17.16872001689642, 19.31854139258756, 20.161495024863115, 11.16749384687517, 33.34319769444625, 25.793408731549587, 15.213478810118641, 30.25429107969905, 29.40010263702269, 20.570761909150793, 14.477435567451078, 18.379997144889785, 13.809456146687992, 11.97067354852233, 25.32983480476416, 15.72787365685437, 5.927075264385317, 24.609837858061784, 7.564918697166872, 24.863936458140696, 7.459367789240613, 36.08735826426265, 7.912423257422385, 21.64543840615885, 37.3254579662849, 54.16618474348663, 5.008264283596738, 24.037461938243965, 17.11260424304337, 50.91137108883662, 48.904322163722874, 12.605367427682827, 20.75292122799779, 4.369677953004909, 16.14781647832791, 37.66397441663601, 18.22463949766004, 18.730154234805457, 17.472660196932516, 19.492852025227744, 25.675750484648827, 13.281930770633968, 19.17474901604545, 28.475448032816395, 35.65475563264983, 10.66639808960734, 33.56409289235496, 32.931438944506986, 7.58568951668672, 31.37483640265382]
rms of radial distance for 100 Random Walks (2D)=  28.28631001415393
Average displacement in X-direction =  -1.4122456921620228
Average displacement in Y-direction =  -2.996985178431556

Please enter the number of steps:1200
A graph has been plotted for 5 Random Walks with  1200  steps.
List of radial distance R for 100 Random Walks (2D)=  [31.72164640337923, 29.05464803344027, 43.28256318700894, 30.02741572254248, 23.243054227425095, 37.33873313082892, 55.73642280840573, 44.247189168539485, 21.012683608902414, 56.76871156214869, 22.262790859920308, 42.982789547042636, 15.015509873184818, 46.23687120410369, 16.164976662465858, 27.256009784630333, 24.220540437236934, 25.008985328746675, 56.281894389608404, 67.43367474961407, 15.573080625512038, 26.724602512833968, 47.532404396298524, 32.87459346899381, 23.21495488252185, 21.100786579095598, 33.39541902475591, 27.190047673500835, 27.120512032363546, 21.639840999896425, 23.688973213219306, 21.130999253614544, 22.86663690777098, 27.39408601111488, 9.700697356294558, 34.92491409523286, 32.065484201885944, 35.85634421317738, 28.612179057500676, 45.89292728651106, 20.93780720359251, 24.460748316376172, 33.02791251105459, 27.775423761940512, 35.66691028664069, 17.444396908603263, 42.652359988515244, 23.481376750628694, 39.63166928743236, 23.671885578229, 47.69419645708199, 20.57256490754245, 22.87528485496703, 26.18603790157906, 20.247732798545037, 34.52349416541496, 4.99311912940419, 31.576140360154202, 36.90736709644544, 17.840971759424654, 1.534877036450736, 30.146630845825957, 33.26015989841088, 15.224043054103184, 23.027680908190863, 5.534472668232489, 34.99440581971818, 75.47483746301202, 26.051130127427015, 41.721261502785644, 22.832146315528167, 8.040540447294365, 23.704401994597177, 11.27068175123405, 17.277880870431318, 25.622952686415708, 6.234616090327342, 63.90943704364241, 12.706482457993118, 6.7451262665798115, 58.730685318644184, 20.079909072887144, 20.33822411043279, 16.97615953147917, 10.128387348470252, 8.89033424596312, 24.156149763606205, 23.062717579945225, 37.987713624396854, 44.76013438537981, 4.450625193668002, 36.09437977566968, 7.138574218981794, 44.38814693141247, 21.334651292860634, 32.222673833189866, 5.8772650085344535, 18.096742079903766, 24.482493538919552, 16.892655505075314]
rms of radial distance for 100 Random Walks (2D)=  31.36559615787247
Average displacement in X-direction =  -1.6959848981875254
Average displacement in Y-direction =  0.4080651689033082

Please enter the number of steps:1500
A graph has been plotted for 5 Random Walks with  1500  steps.
List of radial distance R for 100 Random Walks (2D)=  [1.9619334079777695, 69.19965958884292, 41.230378655387135, 33.65153487223301, 50.90884570227491, 25.98488236116798, 15.463746781767584, 16.897872230909556, 19.88306065042047, 28.789349788300356, 32.718437526234396, 54.23203741572576, 59.18346586788009, 24.503295639027524, 12.591690597826856, 59.44442990889923, 16.978003911434996, 16.68811032461811, 51.52450118511152, 48.141477623830184, 55.40145119911157, 23.861540126122758, 6.50182989029187, 62.5782864979826, 20.034124920970772, 61.91173484384544, 56.71291774330127, 68.48862038018082, 24.62319104417656, 61.659091556304055, 24.508670703609745, 48.780499673714225, 6.644495035323365, 15.985948607639664, 56.541836643997186, 40.035398307243845, 6.817145122260201, 56.458832661751636, 32.42691671618011, 52.3250705919737, 6.587333117309475, 25.427165419112672, 34.84870954406515, 8.219804097763175, 59.322370176014964, 27.528936038265847, 35.82190726958425, 41.87962793918035, 20.360202993866064, 19.12605665854164, 29.616846131574246, 31.77724660957442, 47.506061172437775, 36.57252194063306, 32.805910032098694, 41.28049092332682, 23.61023530201612, 15.20277047886131, 54.73160404329229, 28.002808308260335, 51.579525394814056, 11.748592825786712, 4.388927868143682, 14.000373836556797, 14.627876613940433, 44.39169952261693, 58.374296112019394, 40.64901681696529, 39.921326047883234, 52.11626220891274, 37.011887339475116, 34.60263462022346, 69.05158838504101, 14.507979272963732, 6.1020127124407075, 17.163827811203173, 27.295377129063507, 39.344356993497485, 27.75631091518169, 34.28602577157414, 35.433948222869454, 17.048966477643106, 45.856830316711964, 53.51688933387294, 23.534740803595806, 41.684636637427374, 16.780042492644263, 22.257771054014768, 25.321969734954916, 41.8725057967933, 36.969725229775825, 13.642328206129676, 61.98368919972737, 45.445475222739475, 50.70337191397146, 39.675773186780994, 34.78549545708704, 20.264693809281194, 6.939803699224539, 14.194847688946217]
rms of radial distance for 100 Random Walks (2D)=  37.98275834278915
Average displacement in X-direction =  -6.120510185964823
Average displacement in Y-direction =  -0.4085293046703893

List of square root of N= [15.811388300841896, 22.360679774997898, 28.284271247461902, 34.64101615137755, 38.72983346207417]
List of rms of Radial distance for each N= [14.808983460146171, 21.468669791136715, 28.28631001415393, 31.36559615787247, 37.98275834278915]
'''
